<!DOCTYPE html>
<!--
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                    ASSISTANT M√âDICAL IA v4.0 ULTIMATE           ‚ïë
‚ïë                         COPYRIGHT PROTECTION                      ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë ¬© 2025 NEXYNA - TOUS DROITS R√âSERV√âS                           ‚ïë
‚ïë ¬© 2025 NEXYNA - ALL RIGHTS RESERVED                            ‚ïë
‚ïë                                                                  ‚ïë
‚ïë Auteur : Amine Kheloufi (amine@nexyna.ai)                      ‚ïë
‚ïë Author : Amine Kheloufi (amine@nexyna.ai)                      ‚ïë
‚ïë Premi√®re publication : 02/08/2025                              ‚ïë
‚ïë                                                                  ‚ïë
‚ïë ‚ö†Ô∏è  REPRODUCTION INTERDITE SANS AUTORISATION                   ‚ïë
‚ïë ‚ö†Ô∏è  REPRODUCTION PROHIBITED WITHOUT AUTHORIZATION              ‚ïë
‚ïë                                                                  ‚ïë
‚ïë Toute violation sera poursuivie selon la loi                   ‚ïë
‚ïë Any violation will be prosecuted according to law              ‚ïë
‚ïë                                                                  ‚ïë
‚ïë Voir LICENSE pour conditions d'utilisation                     ‚ïë
‚ïë See LICENSE file for usage terms                               ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
-->
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assistant M√©dical IA 4.0 - Nexyna Pro Max</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .container {
            position: relative;
            z-index: 10;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            max-width: 1600px;
            width: 95%;
            margin: 20px auto;
            overflow: hidden;
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .version-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: bold;
        }

        .language-selector {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 5px;
        }

        .language-selector select {
            background: transparent;
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 10px;
        }

        .cloud-status {
            position: absolute;
            top: 50px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4caf50;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .main-nav {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            overflow-x: auto;
        }

        .nav-tab {
            padding: 12px 20px;
            border: none;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab.active {
            background: #2196F3;
            color: white;
        }

        .nav-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .main-content {
            display: grid;
            grid-template-columns: 350px 1fr 400px;
            gap: 30px;
        }

        /* Panneau patient */
        .patient-panel {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 15px;
        }

        .form-group label {
            font-weight: 600;
            color: #1976D2;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .form-group input, .form-group select, .form-group textarea {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .patient-summary {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
            font-size: 13px;
        }

        /* Capteurs biom√©triques */
        .sensors-panel {
            background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .sensor-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .sensor-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .sensor-value {
            font-size: 1.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .sensor-trend {
            font-size: 12px;
            color: #4caf50;
        }

        /* Corps interactif */
        .body-panel {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        .body-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .body-type-btn {
            padding: 10px 20px;
            border: 2px solid #2196F3;
            background: white;
            color: #2196F3;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .body-type-btn.active {
            background: #2196F3;
            color: white;
        }

        .view-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .view-btn {
            padding: 8px 15px;
            border: 1px solid #ccc;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
        }

        .view-btn.active {
            background: #4caf50;
            color: white;
        }

        .body-container {
            position: relative;
            width: 100%;
            height: 500px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .body-svg {
            width: 100%;
            max-width: 280px;
            height: 450px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .body-part {
            fill: #e3f2fd;
            stroke: #2196F3;
            stroke-width: 2;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .body-part:hover {
            fill: #2196F3;
            stroke: #1976D2;
            stroke-width: 3;
            filter: drop-shadow(0 5px 15px rgba(33, 150, 243, 0.4));
        }

        .body-part.selected {
            fill: #f44336;
            stroke: #d32f2f;
            stroke-width: 3;
            animation: pulseBody 1s ease-in-out infinite;
        }

        @keyframes pulseBody {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pain-scale {
            margin: 20px 0;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .pain-slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: linear-gradient(to right, #4caf50, #ffeb3b, #ff9800, #f44336);
            outline: none;
            margin: 15px 0;
        }

        .pain-display {
            text-align: center;
            font-size: 1.8em;
            font-weight: bold;
            margin: 10px 0;
        }

        /* Panneau sympt√¥mes */
        .symptoms-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .voice-controls {
            background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .voice-btn {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin: 10px 0;
        }

        .voice-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.3);
        }

        .voice-btn.recording {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            animation: recordingPulse 1s ease-in-out infinite;
        }

        @keyframes recordingPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .quick-symptoms {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .symptom-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .symptom-tag {
            background: #f5f5f5;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
        }

        .symptom-tag:hover {
            background: #2196F3;
            color: white;
        }

        .symptom-tag.selected {
            background: #4caf50;
            color: white;
        }

        .question-input {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .question-input textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 14px;
            min-height: 120px;
            resize: vertical;
            transition: all 0.3s ease;
        }

        .question-input textarea:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .analyze-btn {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 15px;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(33, 150, 243, 0.3);
        }

        /* IA avanc√©e */
        .ai-panel {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .ai-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .ai-indicator {
            width: 12px;
            height: 12px;
            background: #4caf50;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .confidence-meter {
            background: #e0e0e0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #f44336, #ff9800, #4caf50);
            transition: width 0.3s ease;
            width: 0%;
        }

        /* Section r√©ponse */
        .response-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-left: 5px solid #2196F3;
            display: none;
            grid-column: 1 / -1;
        }

        .response-section.show {
            display: block;
            animation: expandIn 0.6s ease-out;
        }

        @keyframes expandIn {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .emergency-alert {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            animation: emergencyBlink 1s ease-in-out infinite;
        }

        @keyframes emergencyBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .loading {
            display: none;
            text-align: center;
            padding: 30px;
            background: white;
            border-radius: 15px;
            margin: 20px 0;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2196F3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .disclaimer {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 1px solid #ffeaa7;
            border-radius: 15px;
            padding: 20px;
            margin: 30px 0;
            font-size: 14px;
            color: #856404;
            grid-column: 1 / -1;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                width: calc(100% - 20px);
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <!-- Particules d'arri√®re-plan -->
    <div class="particles" id="particles"></div>

    <div class="container">
        <div class="header">
            <!-- S√©lecteur de langue -->
            <div class="language-selector">
                <select id="languageSelect">
                    <option value="fr">üá´üá∑ Fran√ßais</option>
                    <option value="en">üá¨üáß English</option>
                    <option value="es">üá™üá∏ Espa√±ol</option>
                    <option value="de">üá©üá™ Deutsch</option>
                    <option value="it">üáÆüáπ Italiano</option>
                    <option value="ar">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                </select>
            </div>

            <!-- Statut cloud -->
            <div class="cloud-status" id="cloudStatus">
                <div class="status-indicator"></div>
                <span>Cloud connect√©</span>
            </div>

            <div class="version-badge">v4.0 ULTIMATE</div>
            <h1>üè• Assistant M√©dical IA Ultimate</h1>
            <p>Plateforme m√©dicale intelligente avec IA, t√©l√©consultation et capteurs IoT</p>
        </div>

        <!-- Navigation par onglets -->
        <div class="main-nav">
            <div class="nav-tabs">
                <button class="nav-tab active" data-tab="consultation">
                    ü©∫ Consultation
                </button>
                <button class="nav-tab" data-tab="database">
                    üìö Base M√©dicale
                </button>
                <button class="nav-tab" data-tab="teleconsult">
                    üìπ T√©l√©consultation
                </button>
                <button class="nav-tab" data-tab="timeline">
                    üìà Suivi Temporal
                </button>
                <button class="nav-tab" data-tab="sensors">
                    üì± Capteurs IoT
                </button>
                <button class="nav-tab" data-tab="ai">
                    ü§ñ IA Avanc√©e
                </button>
                <button class="nav-tab" data-tab="cloud">
                    ‚òÅÔ∏è Cloud Sync
                </button>
            </div>
        </div>

        <!-- Onglet Consultation -->
        <div class="tab-content active" id="consultation">
            <div class="main-content">
                <!-- Panneau Patient -->
                <div class="patient-panel">
                    <h3 style="color: #1976D2; margin-bottom: 20px;">üë§ Informations Patient</h3>
                    <form class="patient-form" id="patientForm">
                        <div class="form-group">
                            <label for="firstName">Pr√©nom *</label>
                            <input type="text" id="firstName" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="lastName">Nom *</label>
                            <input type="text" id="lastName" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="birthDate">Date de naissance *</label>
                            <input type="date" id="birthDate" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="gender">Sexe *</label>
                            <select id="gender" required>
                                <option value="">S√©lectionner</option>
                                <option value="homme">Homme</option>
                                <option value="femme">Femme</option>
                                <option value="enfant-garcon">Enfant (Gar√ßon)</option>
                                <option value="enfant-fille">Enfant (Fille)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="weight">Poids (kg)</label>
                            <input type="number" id="weight" min="1" max="300">
                        </div>
                        
                        <div class="form-group">
                            <label for="height">Taille (cm)</label>
                            <input type="number" id="height" min="50" max="250">
                        </div>
                        
                        <div class="form-group">
                            <label for="allergies">Allergies connues</label>
                            <textarea id="allergies" rows="2" placeholder="M√©dicaments, aliments, substances..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="medications">Traitements actuels</label>
                            <textarea id="medications" rows="2" placeholder="M√©dicaments pris r√©guli√®rement..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="medicalHistory">Ant√©c√©dents m√©dicaux</label>
                            <textarea id="medicalHistory" rows="3" placeholder="Maladies, op√©rations, hospitalisations..."></textarea>
                        </div>
                    </form>
                    
                    <div class="patient-summary" id="patientSummary">
                        <strong>üìã R√©sum√©:</strong>
                        <div id="summaryContent">Remplissez les informations ci-dessus</div>
                    </div>

                    <!-- Capteurs biom√©triques -->
                    <div class="sensors-panel">
                        <h4 style="color: #1976D2; margin-bottom: 10px;">üì± Capteurs Biom√©triques</h4>
                        <div class="sensor-grid">
                            <div class="sensor-card">
                                <div style="font-size: 12px; color: #666;">Rythme Cardiaque</div>
                                <div class="sensor-value" id="heartRate">--</div>
                                <div class="sensor-trend" id="heartTrend">--</div>
                            </div>
                            <div class="sensor-card">
                                <div style="font-size: 12px; color: #666;">Temp√©rature</div>
                                <div class="sensor-value" id="temperature">--</div>
                                <div class="sensor-trend" id="tempTrend">--</div>
                            </div>
                            <div class="sensor-card">
                                <div style="font-size: 12px; color: #666;">Tension</div>
                                <div class="sensor-value" id="bloodPressure">--</div>
                                <div class="sensor-trend" id="pressureTrend">--</div>
                            </div>
                            <div class="sensor-card">
                                <div style="font-size: 12px; color: #666;">SpO2</div>
                                <div class="sensor-value" id="oxygenSat">--</div>
                                <div class="sensor-trend" id="oxygenTrend">--</div>
                            </div>
                        </div>
                        <button class="voice-btn" onclick="connectSensors()">
                            üì± Connecter capteurs
                        </button>
                    </div>
                </div>

                <!-- Panneau Corps -->
                <div class="body-panel">
                    <h3 style="color: #1976D2; margin-bottom: 20px;">ü´Å Localisation des sympt√¥mes</h3>
                    
                    <!-- Contr√¥les type de corps -->
                    <div class="body-controls">
                        <button class="body-type-btn active" data-type="homme">üë® Homme</button>
                        <button class="body-type-btn" data-type="femme">üë© Femme</button>
                        <button class="body-type-btn" data-type="enfant">üßí Enfant</button>
                    </div>
                    
                    <!-- Contr√¥les de vue -->
                    <div class="view-controls">
                        <button class="view-btn active" data-view="face">Face</button>
                        <button class="view-btn" data-view="profile">Profil</button>
                        <button class="view-btn" data-view="back">Dos</button>
                    </div>
                    
                    <!-- Container du corps -->
                    <div class="body-container">
                        <svg class="body-svg" viewBox="0 0 300 450" id="bodySvg">
                            <!-- Corps Homme Face -->
                            <g id="homme-face" class="body-view">
                                <!-- T√™te -->
                                <ellipse class="body-part" data-part="t√™te" cx="150" cy="50" rx="35" ry="40" />
                                <!-- Cou -->
                                <rect class="body-part" data-part="cou" x="135" y="90" width="30" height="25" />
                                <!-- √âpaules -->
                                <ellipse class="body-part" data-part="√©paule gauche" cx="100" cy="130" rx="25" ry="15" />
                                <ellipse class="body-part" data-part="√©paule droite" cx="200" cy="130" rx="25" ry="15" />
                                <!-- Torse -->
                                <rect class="body-part" data-part="poitrine" x="110" y="115" width="80" height="80" />
                                <!-- Bras -->
                                <rect class="body-part" data-part="bras gauche" x="70" y="140" width="25" height="80" />
                                <rect class="body-part" data-part="bras droit" x="205" y="140" width="25" height="80" />
                                <!-- Avant-bras -->
                                <rect class="body-part" data-part="avant-bras gauche" x="72" y="220" width="21" height="70" />
                                <rect class="body-part" data-part="avant-bras droit" x="207" y="220" width="21" height="70" />
                                <!-- Mains -->
                                <ellipse class="body-part" data-part="main gauche" cx="82" cy="305" rx="12" ry="18" />
                                <ellipse class="body-part" data-part="main droite" cx="218" cy="305" rx="12" ry="18" />
                                <!-- Abdomen -->
                                <rect class="body-part" data-part="abdomen" x="115" y="195" width="70" height="70" />
                                <!-- Hanches -->
                                <rect class="body-part" data-part="bassin" x="120" y="265" width="60" height="40" />
                                <!-- Cuisses -->
                                <rect class="body-part" data-part="cuisse gauche" x="125" y="305" width="25" height="80" />
                                <rect class="body-part" data-part="cuisse droite" x="150" y="305" width="25" height="80" />
                                <!-- Genoux -->
                                <circle class="body-part" data-part="genou gauche" cx="137" cy="385" r="12" />
                                <circle class="body-part" data-part="genou droit" cx="162" cy="385" r="12" />
                                <!-- Jambes -->
                                <rect class="body-part" data-part="jambe gauche" x="127" y="397" width="20" height="75" />
                                <rect class="body-part" data-part="jambe droite" x="153" y="397" width="20" height="75" />
                                <!-- Pieds -->
                                <ellipse class="body-part" data-part="pied gauche" cx="137" cy="485" rx="18" ry="12" />
                                <ellipse class="body-part" data-part="pied droit" cx="162" cy="485" rx="18" ry="12" />
                            </g>
                            
                            <!-- Corps Femme Face (cach√© par d√©faut) -->
                            <g id="femme-face" class="body-view" style="display: none;">
                                <ellipse class="body-part" data-part="t√™te" cx="150" cy="50" rx="32" ry="38" />
                                <rect class="body-part" data-part="cou" x="138" y="88" width="24" height="22" />
                                <ellipse class="body-part" data-part="√©paule gauche" cx="105" cy="125" rx="22" ry="12" />
                                <ellipse class="body-part" data-part="√©paule droite" cx="195" cy="125" rx="22" ry="12" />
                                <rect class="body-part" data-part="poitrine" x="115" y="110" width="70" height="75" />
                                <rect class="body-part" data-part="bras gauche" x="75" y="135" width="22" height="75" />
                                <rect class="body-part" data-part="bras droit" x="203" y="135" width="22" height="75" />
                                <rect class="body-part" data-part="avant-bras gauche" x="77" y="210" width="18" height="65" />
                                <rect class="body-part" data-part="avant-bras droit" x="205" y="210" width="18" height="65" />
                                <ellipse class="body-part" data-part="main gauche" cx="86" cy="285" rx="10" ry="15" />
                                <ellipse class="body-part" data-part="main droite" cx="214" cy="285" rx="10" ry="15" />
                                <rect class="body-part" data-part="abdomen" x="120" y="185" width="60" height="65" />
                                <ellipse class="body-part" data-part="bassin" cx="150" cy="275" rx="35" ry="25" />
                                <rect class="body-part" data-part="cuisse gauche" x="130" y="300" width="22" height="85" />
                                <rect class="body-part" data-part="cuisse droite" x="148" y="300" width="22" height="85" />
                                <circle class="body-part" data-part="genou gauche" cx="141" cy="385" r="10" />
                                <circle class="body-part" data-part="genou droit" cx="159" cy="385" r="10" />
                                <rect class="body-part" data-part="jambe gauche" x="133" y="395" width="16" height="75" />
                                <rect class="body-part" data-part="jambe droite" x="151" y="395" width="16" height="75" />
                                <ellipse class="body-part" data-part="pied gauche" cx="141" cy="480" rx="15" ry="10" />
                                <ellipse class="body-part" data-part="pied droit" cx="159" cy="480" rx="15" ry="10" />
                            </g>
                            
                            <!-- Corps Enfant Face (cach√© par d√©faut) -->
                            <g id="enfant-face" class="body-view" style="display: none;">
                                <ellipse class="body-part" data-part="t√™te" cx="150" cy="60" rx="40" ry="45" />
                                <rect class="body-part" data-part="cou" x="140" y="105" width="20" height="15" />
                                <ellipse class="body-part" data-part="√©paule gauche" cx="110" cy="135" rx="20" ry="10" />
                                <ellipse class="body-part" data-part="√©paule droite" cx="190" cy="135" rx="20" ry="10" />
                                <rect class="body-part" data-part="poitrine" x="120" y="120" width="60" height="60" />
                                <rect class="body-part" data-part="bras gauche" x="85" y="140" width="18" height="60" />
                                <rect class="body-part" data-part="bras droit" x="197" y="140" width="18" height="60" />
                                <rect class="body-part" data-part="avant-bras gauche" x="87" y="200" width="14" height="50" />
                                <rect class="body-part" data-part="avant-bras droit" x="199" y="200" width="14" height="50" />
                                <ellipse class="body-part" data-part="main gauche" cx="94" cy="260" rx="8" ry="12" />
                                <ellipse class="body-part" data-part="main droite" cx="206" cy="260" rx="8" ry="12" />
                                <rect class="body-part" data-part="abdomen" x="125" y="180" width="50" height="50" />
                                <rect class="body-part" data-part="bassin" x="130" y="230" width="40" height="30" />
                                <rect class="body-part" data-part="cuisse gauche" x="135" y="260" width="18" height="70" />
                                <rect class="body-part" data-part="cuisse droite" x="147" y="260" width="18" height="70" />
                                <circle class="body-part" data-part="genou gauche" cx="144" cy="330" r="8" />
                                <circle class="body-part" data-part="genou droit" cx="156" cy="330" r="8" />
                                <rect class="body-part" data-part="jambe gauche" x="138" y="338" width="12" height="60" />
                                <rect class="body-part" data-part="jambe droite" x="150" y="338" width="12" height="60" />
                                <ellipse class="body-part" data-part="pied gauche" cx="144" cy="408" rx="12" ry="8" />
                                <ellipse class="body-part" data-part="pied droit" cx="156" cy="408" rx="12" ry="8" />
                            </g>
                        </svg>
                    </div>
                    
                    <div id="selectedPart" style="margin-top: 15px; font-weight: bold; color: #1976D2;"></div>
                    
                    <!-- √âchelle de douleur -->
                    <div class="pain-scale">
                        <h4 style="color: #1976D2; margin-bottom: 10px;">üìä Intensit√© de la douleur</h4>
                        <input type="range" class="pain-slider" id="painScale" min="0" max="10" value="0">
                        <div class="pain-display" id="painDisplay">üòä 0/10</div>
                        <div style="display: flex; justify-content: space-between; font-size: 11px; color: #666;">
                            <span>Aucune</span>
                            <span>L√©g√®re</span>
                            <span>Mod√©r√©e</span>
                            <span>S√©v√®re</span>
                            <span>Extr√™me</span>
                        </div>
                    </div>
                </div>

                <!-- Panneau Sympt√¥mes -->
                <div class="symptoms-panel">
                    <!-- Reconnaissance vocale -->
                    <div class="voice-controls">
                        <h4 style="color: #1976D2; margin-bottom: 15px;">üé§ Reconnaissance vocale</h4>
                        <button class="voice-btn" id="voiceBtn">
                            <span id="voiceText">üé§ Cliquez et d√©crivez vos sympt√¥mes</span>
                        </button>
                        <div id="voiceResult" style="margin-top: 10px; font-style: italic; color: #666; font-size: 13px;"></div>
                    </div>

                    <!-- Sympt√¥mes rapides -->
                    <div class="quick-symptoms">
                        <h4 style="color: #1976D2; margin-bottom: 10px;">‚ö° Sympt√¥mes fr√©quents</h4>
                        <div class="symptom-tags">
                            <span class="symptom-tag" data-symptom="mal de t√™te">Mal de t√™te</span>
                            <span class="symptom-tag" data-symptom="fi√®vre">Fi√®vre</span>
                            <span class="symptom-tag" data-symptom="naus√©e">Naus√©e</span>
                            <span class="symptom-tag" data-symptom="fatigue">Fatigue</span>
                            <span class="symptom-tag" data-symptom="toux">Toux</span>
                            <span class="symptom-tag" data-symptom="douleur musculaire">Douleur musculaire</span>
                            <span class="symptom-tag" data-symptom="vertige">Vertige</span>
                            <span class="symptom-tag" data-symptom="insomnie">Insomnie</span>
                            <span class="symptom-tag" data-symptom="douleur abdominale">Douleur abdominale</span>
                            <span class="symptom-tag" data-symptom="difficult√© respiration">Difficult√© √† respirer</span>
                        </div>
                    </div>

                    <!-- IA Avanc√©e -->
                    <div class="ai-panel">
                        <div class="ai-status">
                            <div class="ai-indicator"></div>
                            <span>IA M√©dicale Active</span>
                        </div>
                        <div>Niveau de confiance:</div>
                        <div class="confidence-meter">
                            <div class="confidence-fill" id="confidenceFill"></div>
                        </div>
                        <div style="font-size: 12px; color: #666;" id="aiInsight">En attente d'analyse...</div>
                    </div>

                    <!-- Description d√©taill√©e -->
                    <div class="question-input">
                        <h4 style="color: #1976D2; margin-bottom: 15px;">‚úçÔ∏è Description d√©taill√©e</h4>
                        <textarea id="questionInput" placeholder="D√©crivez pr√©cis√©ment vos sympt√¥mes, leur d√©but, leur √©volution, les facteurs aggravants ou soulageants...

Exemple: 'Douleur pulsatile au niveau temporal droit depuis hier matin, s'aggrave avec la lumi√®re, accompagn√©e de naus√©es...'"></textarea>
                        
                        <button class="analyze-btn" id="analyzeBtn">
                            üîç Lancer l'analyse compl√®te
                        </button>
                    </div>
                </div>

                <!-- Loading -->
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p id="loadingText">Analyse en cours avec IA avanc√©e...</p>
                </div>

                <!-- Section R√©ponse -->
                <div class="response-section" id="responseSection">
                    <div style="display: flex; align-items: center; margin-bottom: 20px;">
                        <div style="background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%); color: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 20px; font-size: 20px;">ü©∫</div>
                        <h3>Diagnostic IA - Rapport Complet</h3>
                        <div style="margin-left: auto;">
                            <button class="voice-btn" onclick="exportToPDF()" style="background: #4caf50; padding: 10px 20px; margin: 5px;">üìÑ Export PDF</button>
                            <button class="voice-btn" onclick="saveToHistory()" style="background: #ff9800; padding: 10px 20px; margin: 5px;">üíæ Sauvegarder</button>
                        </div>
                    </div>
                    <div id="responseContent"></div>
                </div>

                <!-- Disclaimer -->
                <div class="disclaimer">
                    <strong>‚ö†Ô∏è Avertissement m√©dical important :</strong> 
                    Cet assistant utilise une intelligence artificielle avanc√©e pour analyser vos sympt√¥mes et fournir des informations m√©dicales. 
                    Il constitue un outil d'aide au pr√©-diagnostic mais ne remplace en aucun cas l'avis d'un professionnel de sant√© qualifi√©. 
                    En cas d'urgence m√©dicale, de doute ou d'aggravation des sympt√¥mes, consultez imm√©diatement un m√©decin ou appelez le 15 (SAMU), 
                    le 18 (Pompiers) ou le 112 (num√©ro d'urgence europ√©en).
                </div>
            </div>
        </div>

        <!-- Autres onglets (placeholders) -->
        <div class="tab-content" id="database">
            <h3>üìö Base de Donn√©es M√©dicale</h3>
            <p>Fonctionnalit√© en d√©veloppement...</p>
        </div>

        <div class="tab-content" id="teleconsult">
            <h3>üìπ T√©l√©consultation</h3>
            <p>Fonctionnalit√© en d√©veloppement...</p>
        </div>

        <div class="tab-content" id="timeline">
            <h3>üìà Suivi Temporal</h3>
            <p>Fonctionnalit√© en d√©veloppement...</p>
        </div>

        <div class="tab-content" id="sensors">
            <h3>üì± Capteurs IoT</h3>
            <p>Fonctionnalit√© en d√©veloppement...</p>
        </div>

        <div class="tab-content" id="ai">
            <h3>ü§ñ IA Avanc√©e</h3>
            <p>Fonctionnalit√© en d√©veloppement...</p>
        </div>

        <div class="tab-content" id="cloud">
            <h3>‚òÅÔ∏è Cloud Sync</h3>
            <p>Fonctionnalit√© en d√©veloppement...</p>
        </div>
    </div>

    <!-- Watermark Copyright Kheloufi -->
    <div class="nexyna-watermark" style="position: fixed; bottom: 10px; right: 10px; background: linear-gradient(135deg, #2196F3, #1976D2); color: white; padding: 8px 12px; border-radius: 15px; font-size: 11px; z-index: 9999; backdrop-filter: blur(10px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2);">
        <div style="display: flex; align-items: center; gap: 5px;">
            <span>üè•</span>
            <span style="font-weight: bold;">¬© 2025 Kheloufi</span>
        </div>
        <div style="font-size: 9px; opacity: 0.8; text-align: center;">v4.0 Ultimate</div>
        <div style="font-size: 8px; opacity: 0.6; text-align: center;">amine@nexyna.ai</div>
    </div>

    <script>
        // üõ°Ô∏è PROTECTION COPYRIGHT KHELOUFI
        console.clear();
        console.log('%cüè• ASSISTANT M√âDICAL IA v4.0 ULTIMATE', 'color: #2196F3; font-size: 20px; font-weight: bold;');
        console.log('%c¬© 2025 KHELOUFI - Amine Kheloufi', 'color: #f44336; font-size: 14px; font-weight: bold;');
        console.log('%cüìß Contact: amine@nexyna.ai', 'color: #4caf50; font-size: 12px;');
        console.log('%c‚ö†Ô∏è Code prot√©g√© par copyright - Reproduction interdite', 'color: #ff9800; font-size: 12px;');
        console.log('%cüö´ Any unauthorized reproduction is prohibited', 'color: #ff9800; font-size: 12px;');
        console.log('%cüìã Voir LICENSE pour autorisations', 'color: #9c27b0; font-size: 12px;');

        class MedicalAssistantV4 {
            constructor() {
                this.patient = {};
                this.selectedBodyPart = '';
                this.selectedSymptoms = [];
                this.painLevel = 0;
                this.currentBodyType = 'homme';
                this.currentView = 'face';
                this.voiceRecognition = null;
                this.consultationHistory = [];
                this.sensorData = {
                    heartRate: 0,
                    temperature: 0,
                    bloodPressure: '0/0',
                    oxygenSat: 0
                };
                this.sensorsConnected = false;
                
                this.initializeElements();
                this.attachEventListeners();
                this.createParticles();
                this.initializeVoiceRecognition();
                this.startSensorSimulation();
            }

            initializeElements() {
                // Navigation
                this.navTabs = document.querySelectorAll('.nav-tab');
                this.tabContents = document.querySelectorAll('.tab-content');
                
                // Patient form elements
                this.patientForm = document.getElementById('patientForm');
                this.patientSummary = document.getElementById('summaryContent');
                
                // Body diagram elements
                this.bodySvg = document.getElementById('bodySvg');
                this.selectedPartDisplay = document.getElementById('selectedPart');
                this.painScale = document.getElementById('painScale');
                this.painDisplay = document.getElementById('painDisplay');
                
                // Voice and symptoms elements
                this.voiceBtn = document.getElementById('voiceBtn');
                this.voiceText = document.getElementById('voiceText');
                this.voiceResult = document.getElementById('voiceResult');
                this.questionInput = document.getElementById('questionInput');
                this.analyzeBtn = document.getElementById('analyzeBtn');
                
                // AI elements
                this.confidenceFill = document.getElementById('confidenceFill');
                this.aiInsight = document.getElementById('aiInsight');
                
                // Response elements
                this.loading = document.getElementById('loading');
                this.loadingText = document.getElementById('loadingText');
                this.responseSection = document.getElementById('responseSection');
                this.responseContent = document.getElementById('responseContent');
            }

            attachEventListeners() {
                try {
                    // Navigation tabs
                    this.navTabs.forEach(tab => {
                        tab.addEventListener('click', (e) => this.switchTab(e.target.dataset.tab));
                    });
                    
                    // Patient form
                    this.patientForm.addEventListener('input', () => this.updatePatientSummary());
                    
                    // Body type controls
                    document.querySelectorAll('.body-type-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => this.switchBodyType(e.target.dataset.type));
                    });
                    
                    // View controls
                    document.querySelectorAll('.view-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => this.switchView(e.target.dataset.view));
                    });
                    
                    // Body diagram
                    this.bodySvg.addEventListener('click', (e) => {
                        if (e.target.classList.contains('body-part')) {
                            this.selectBodyPart(e.target);
                        }
                    });
                    
                    // Pain scale
                    this.painScale.addEventListener('input', (e) => {
                        this.updatePainLevel(e.target.value);
                    });
                    
                    // Symptom tags
                    document.querySelectorAll('.symptom-tag').forEach(tag => {
                        tag.addEventListener('click', (e) => this.toggleSymptom(e.target));
                    });
                    
                    // Voice recognition
                    this.voiceBtn.addEventListener('click', () => this.toggleVoiceRecognition());
                    
                    // Analysis
                    this.analyzeBtn.addEventListener('click', () => this.analyzeSymptoms());
                    
                    // AI real-time analysis
                    this.questionInput.addEventListener('input', () => this.updateAIInsight());
                    
                    console.log('‚úÖ Event listeners attached successfully');
                } catch (error) {
                    console.error('‚ùå Error attaching event listeners:', error);
                }
            }

            createParticles() {
                try {
                    const particlesContainer = document.getElementById('particles');
                    for (let i = 0; i < 25; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle';
                        particle.style.left = Math.random() * 100 + '%';
                        particle.style.top = Math.random() * 100 + '%';
                        particle.style.width = Math.random() * 12 + 4 + 'px';
                        particle.style.height = particle.style.width;
                        particle.style.animationDelay = Math.random() * 6 + 's';
                        particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                        particlesContainer.appendChild(particle);
                    }
                } catch (error) {
                    console.error('‚ùå Error creating particles:', error);
                }
            }

            switchTab(tabName) {
                try {
                    // Update nav buttons
                    this.navTabs.forEach(tab => {
                        tab.classList.toggle('active', tab.dataset.tab === tabName);
                    });
                    
                    // Show corresponding content
                    this.tabContents.forEach(content => {
                        content.classList.toggle('active', content.id === tabName);
                    });
                    
                    console.log('‚úÖ Switched to tab:', tabName);
                } catch (error) {
                    console.error('‚ùå Error switching tab:', error);
                }
            }

            updatePatientSummary() {
                try {
                    const firstName = document.getElementById('firstName').value;
                    const lastName = document.getElementById('lastName').value;
                    const birthDate = document.getElementById('birthDate').value;
                    const gender = document.getElementById('gender').value;
                    const weight = document.getElementById('weight').value;
                    const height = document.getElementById('height').value;
                    
                    let summary = '';
                    if (firstName || lastName) {
                        summary += `<div><strong>Patient:</strong> ${firstName} ${lastName}</div>`;
                    }
                    
                    if (birthDate) {
                        const age = this.calculateAge(birthDate);
                        summary += `<div><strong>√Çge:</strong> ${age} ans</div>`;
                    }
                    
                    if (gender) {
                        summary += `<div><strong>Sexe:</strong> ${gender}</div>`;
                    }
                    
                    if (weight && height) {
                        const bmi = (weight / ((height/100) ** 2)).toFixed(1);
                        summary += `<div><strong>IMC:</strong> ${bmi}</div>`;
                    }
                    
                    this.patientSummary.innerHTML = summary || 'Remplissez les informations ci-dessus';
                    
                    // Update patient object
                    this.patient = {
                        firstName,
                        lastName,
                        birthDate,
                        age: birthDate ? this.calculateAge(birthDate) : null,
                        gender,
                        weight: weight ? parseFloat(weight) : null,
                        height: height ? parseFloat(height) : null,
                        allergies: document.getElementById('allergies').value,
                        medications: document.getElementById('medications').value,
                        medicalHistory: document.getElementById('medicalHistory').value
                    };
                } catch (error) {
                    console.error('‚ùå Error updating patient summary:', error);
                }
            }

            calculateAge(birthDate) {
                const birth = new Date(birthDate);
                const today = new Date();
                let age = today.getFullYear() - birth.getFullYear();
                const monthDiff = today.getMonth() - birth.getMonth();
                
                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                    age--;
                }
                
                return age;
            }

            switchBodyType(type) {
                try {
                    this.currentBodyType = type;
                    
                    document.querySelectorAll('.body-type-btn').forEach(btn => {
                        btn.classList.toggle('active', btn.dataset.type === type);
                    });
                    
                    this.updateBodyDisplay();
                    console.log('‚úÖ Switched body type to:', type);
                } catch (error) {
                    console.error('‚ùå Error switching body type:', error);
                }
            }

            switchView(view) {
                try {
                    this.currentView = view;
                    
                    document.querySelectorAll('.view-btn').forEach(btn => {
                        btn.classList.toggle('active', btn.dataset.view === view);
                    });
                    
                    this.updateBodyDisplay();
                    console.log('‚úÖ Switched view to:', view);
                } catch (error) {
                    console.error('‚ùå Error switching view:', error);
                }
            }

            updateBodyDisplay() {
                try {
                    document.querySelectorAll('.body-view').forEach(view => {
                        view.style.display = 'none';
                    });
                    
                    const viewId = `${this.currentBodyType}-${this.currentView}`;
                    const currentView = document.getElementById(viewId);
                    if (currentView) {
                        currentView.style.display = 'block';
                    } else {
                        const faceView = document.getElementById(`${this.currentBodyType}-face`);
                        if (faceView) {
                            faceView.style.display = 'block';
                        }
                    }
                    
                    this.clearBodySelection();
                } catch (error) {
                    console.error('‚ùå Error updating body display:', error);
                }
            }

            clearBodySelection() {
                try {
                    document.querySelectorAll('.body-part').forEach(part => {
                        part.classList.remove('selected');
                    });
                    this.selectedBodyPart = '';
                    this.selectedPartDisplay.textContent = '';
                } catch (error) {
                    console.error('‚ùå Error clearing body selection:', error);
                }
            }

            selectBodyPart(element) {
                try {
                    this.clearBodySelection();
                    
                    element.classList.add('selected');
                    this.selectedBodyPart = element.dataset.part;
                    this.selectedPartDisplay.textContent = `Zone s√©lectionn√©e : ${this.selectedBodyPart}`;
                    
                    console.log('‚úÖ Selected body part:', this.selectedBodyPart);
                } catch (error) {
                    console.error('‚ùå Error selecting body part:', error);
                }
            }

            updatePainLevel(level) {
                try {
                    this.painLevel = level;
                    const emojis = ['üòä', 'üôÇ', 'üòê', 'üòï', 'üòü', 'üò£', 'üòñ', 'üò´', 'üò©', 'üò±', 'üÜò'];
                    const colors = ['#4caf50', '#8bc34a', '#cddc39', '#ffeb3b', '#ffc107', '#ff9800', '#ff5722', '#f44336', '#e91e63', '#9c27b0', '#673ab7'];
                    
                    this.painDisplay.textContent = `${emojis[level]} ${level}/10`;
                    this.painDisplay.style.color = colors[level];
                    
                    if (level >= 8) {
                        this.painDisplay.style.animation = 'pulseBody 0.5s ease-in-out infinite';
                    } else {
                        this.painDisplay.style.animation = 'none';
                    }
                } catch (error) {
                    console.error('‚ùå Error updating pain level:', error);
                }
            }

            toggleSymptom(element) {
                try {
                    const symptom = element.dataset.symptom;
                    
                    if (element.classList.contains('selected')) {
                        element.classList.remove('selected');
                        this.selectedSymptoms = this.selectedSymptoms.filter(s => s !== symptom);
                    } else {
                        element.classList.add('selected');
                        this.selectedSymptoms.push(symptom);
                    }
                    
                    this.updateSymptomText();
                    console.log('‚úÖ Toggled symptom:', symptom);
                } catch (error) {
                    console.error('‚ùå Error toggling symptom:', error);
                }
            }

            updateSymptomText() {
                try {
                    const currentText = this.questionInput.value;
                    const symptomsText = this.selectedSymptoms.join(', ');
                    
                    if (symptomsText && !currentText.includes(symptomsText)) {
                        this.questionInput.value = currentText ? `${currentText}\n\nSympt√¥mes s√©lectionn√©s: ${symptomsText}` : `Sympt√¥mes s√©lectionn√©s: ${symptomsText}`;
                    }
                } catch (error) {
                    console.error('‚ùå Error updating symptom text:', error);
                }
            }

            initializeVoiceRecognition() {
                try {
                    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                        this.voiceRecognition = new SpeechRecognition();
                        this.voiceRecognition.lang = 'fr-FR';
                        this.voiceRecognition.continuous = false;
                        this.voiceRecognition.interimResults = true;

                        this.voiceRecognition.onstart = () => {
                            this.voiceBtn.classList.add('recording');
                            this.voiceText.textContent = 'üî¥ Parlez maintenant...';
                            this.voiceResult.textContent = '√âcoute en cours...';
                        };

                        this.voiceRecognition.onresult = (event) => {
                            let transcript = '';
                            for (let i = 0; i < event.results.length; i++) {
                                transcript += event.results[i][0].transcript;
                            }
                            
                            if (event.results[event.results.length - 1].isFinal) {
                                this.questionInput.value = transcript;
                                this.voiceResult.textContent = `Reconnu: "${transcript}"`;
                                this.updateAIInsight();
                            } else {
                                this.voiceResult.textContent = `En cours: "${transcript}"`;
                            }
                        };

                        this.voiceRecognition.onerror = (event) => {
                            this.voiceResult.textContent = `Erreur: ${event.error}`;
                            this.resetVoiceButton();
                        };

                        this.voiceRecognition.onend = () => {
                            this.resetVoiceButton();
                        };
                        
                        console.log('‚úÖ Voice recognition initialized');
                    } else {
                        this.voiceBtn.style.display = 'none';
                        document.querySelector('.voice-controls').innerHTML = '<p>üö´ Reconnaissance vocale non support√©e</p>';
                    }
                } catch (error) {
                    console.error('‚ùå Error initializing voice recognition:', error);
                }
            }

            toggleVoiceRecognition() {
                try {
                    if (this.voiceRecognition) {
                        if (this.voiceBtn.classList.contains('recording')) {
                            this.voiceRecognition.stop();
                        } else {
                            this.voiceRecognition.start();
                        }
                    }
                } catch (error) {
                    console.error('‚ùå Error toggling voice recognition:', error);
                }
            }

            resetVoiceButton() {
                try {
                    this.voiceBtn.classList.remove('recording');
                    this.voiceText.textContent = 'üé§ Cliquez et d√©crivez vos sympt√¥mes';
                } catch (error) {
                    console.error('‚ùå Error resetting voice button:', error);
                }
            }

            updateAIInsight() {
                try {
                    const text = this.questionInput.value;
                    const confidence = Math.min(text.length * 2, 100);
                    
                    this.confidenceFill.style.width = confidence + '%';
                    
                    if (text.length < 10) {
                        this.aiInsight.textContent = 'En attente d\'analyse...';
                    } else if (text.length < 50) {
                        this.aiInsight.textContent = 'Analyse pr√©liminaire en cours...';
                    } else {
                        const keywords = {
                            'urgence': 'D√©tection de mots-cl√©s d\'urgence - √âvaluation prioritaire',
                            'douleur': 'Analyse de sympt√¥mes douloureux - Pattern reconnu',
                            'fi√®vre': 'Syndrome infectieux possible - Corr√©lation d√©tect√©e',
                            'mal de t√™te': 'C√©phal√©es analys√©es - Multiple causes possibles'
                        };
                        
                        let insight = 'Analyse approfondie termin√©e - ';
                        let found = false;
                        
                        for (const [keyword, message] of Object.entries(keywords)) {
                            if (text.toLowerCase().includes(keyword)) {
                                insight = message;
                                found = true;
                                break;
                            }
                        }
                        
                        if (!found) {
                            insight += 'Sympt√¥mes complexes n√©cessitant √©valuation m√©dicale';
                        }
                        
                        this.aiInsight.textContent = insight;
                    }
                } catch (error) {
                    console.error('‚ùå Error updating AI insight:', error);
                }
            }

            startSensorSimulation() {
                try {
                    setInterval(() => {
                        if (this.sensorsConnected) {
                            this.updateSensorData();
                        }
                    }, 2000);
                } catch (error) {
                    console.error('‚ùå Error starting sensor simulation:', error);
                }
            }

            updateSensorData() {
                try {
                    this.sensorData.heartRate = Math.floor(Math.random() * 40 + 60);
                    this.sensorData.temperature = (Math.random() * 2 + 36.5).toFixed(1);
                    this.sensorData.bloodPressure = `${Math.floor(Math.random() * 40 + 110)}/${Math.floor(Math.random() * 20 + 70)}`;
                    this.sensorData.oxygenSat = Math.floor(Math.random() * 5 + 95);
                    
                    document.getElementById('heartRate').textContent = `${this.sensorData.heartRate} bpm`;
                    document.getElementById('temperature').textContent = `${this.sensorData.temperature}¬∞C`;
                    document.getElementById('bloodPressure').textContent = this.sensorData.bloodPressure;
                    document.getElementById('oxygenSat').textContent = `${this.sensorData.oxygenSat}%`;
                    
                    document.getElementById('heartTrend').textContent = this.sensorData.heartRate > 80 ? '‚ÜóÔ∏è √âlev√©' : '‚úÖ Normal';
                    document.getElementById('tempTrend').textContent = this.sensorData.temperature > 37.5 ? 'üî• Fi√®vre' : '‚úÖ Normal';
                    document.getElementById('pressureTrend').textContent = 'üìä Stable';
                    document.getElementById('oxygenTrend').textContent = this.sensorData.oxygenSat > 97 ? '‚úÖ Excellent' : '‚ö†Ô∏è Surveiller';
                } catch (error) {
                    console.error('‚ùå Error updating sensor data:', error);
                }
            }

            async analyzeSymptoms() {
                try {
                    if (!this.validateInput()) return;
                    
                    this.showLoading();
                    
                    await this.simulateAdvancedAnalysis();
                    const response = this.generateAdvancedResponse();
                    this.showResponse(response);
                } catch (error) {
                    this.showError(error.message);
                } finally {
                    this.hideLoading();
                }
            }

            validateInput() {
                const question = this.questionInput.value.trim();
                
                if (!question && !this.selectedBodyPart && this.selectedSymptoms.length === 0) {
                    alert('‚ö†Ô∏è Veuillez d√©crire vos sympt√¥mes');
                    return false;
                }
                
                return true;
            }

            async simulateAdvancedAnalysis() {
                const steps = [
                    'Initialisation IA m√©dicale v4.0...',
                    'Analyse des sympt√¥mes rapport√©s...',
                    'Consultation base de donn√©es m√©dicale...',
                    '√âvaluation des facteurs de risque...',
                    'G√©n√©ration des recommandations...',
                    'Finalisation du rapport...'
                ];

                for (let i = 0; i < steps.length; i++) {
                    this.loadingText.textContent = steps[i];
                    await new Promise(resolve => setTimeout(resolve, 800));
                }
            }

            generateAdvancedResponse() {
                const symptoms = this.selectedSymptoms.join(', ');
                const painDesc = this.painLevel > 0 ? `Douleur: ${this.painLevel}/10` : '';
                const bodyPartDesc = this.selectedBodyPart ? `Zone: ${this.selectedBodyPart}` : '';
                
                return `
                    <h3>ü©∫ Analyse M√©dicale Compl√®te</h3>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin: 15px 0;">
                        <h4>üë§ Informations Patient</h4>
                        <p><strong>Patient:</strong> ${this.patient.firstName || 'Non sp√©cifi√©'} ${this.patient.lastName || ''}</p>
                        <p><strong>√Çge:</strong> ${this.patient.age || 'Non sp√©cifi√©'} ans</p>
                        <p><strong>Sexe:</strong> ${this.patient.gender || 'Non sp√©cifi√©'}</p>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 12px; margin: 15px 0; border: 2px solid #e3f2fd;">
                        <h4>üîç Analyse des Sympt√¥mes</h4>
                        <p><strong>Description:</strong> "${this.questionInput.value}"</p>
                        ${bodyPartDesc ? `<p><strong>Zone affect√©e:</strong> ${bodyPartDesc}</p>` : ''}
                        ${painDesc ? `<p><strong>Intensit√©:</strong> ${painDesc}</p>` : ''}
                        ${symptoms ? `<p><strong>Sympt√¥mes s√©lectionn√©s:</strong> ${symptoms}</p>` : ''}
                    </div>
                    
                    <div style="background: #e8f5e8; padding: 20px; border-radius: 12px; margin: 15px 0;">
                        <h4>üí° Recommandations</h4>
                        <ul>
                            <li>üè† Repos et hydratation</li>
                            <li>üå°Ô∏è Surveillance des sympt√¥mes</li>
                            <li>üìû Consultation m√©dicale si aggravation</li>
                            <li>üö® Urgences si douleur > 8/10</li>
                        </ul>
                    </div>
                    
                    <div style="background: #e3f2fd; padding: 20px; border-radius: 12px; margin: 15px 0;">
                        <h4>üìÖ Suivi</h4>
                        <p><strong>Consultation recommand√©e :</strong> Dans les 24-48h si persistance</p>
                        <p><strong>Urgences :</strong> 15 (SAMU) - 18 (Pompiers) - 112</p>
                    </div>
                `;
            }

            showLoading() {
                try {
                    this.analyzeBtn.disabled = true;
                    this.loading.classList.add('show');
                    this.responseSection.classList.remove('show');
                } catch (error) {
                    console.error('‚ùå Error showing loading:', error);
                }
            }

            hideLoading() {
                try {
                    this.analyzeBtn.disabled = false;
                    this.loading.classList.remove('show');
                } catch (error) {
                    console.error('‚ùå Error hiding loading:', error);
                }
            }

            showResponse(response) {
                try {
                    this.responseContent.innerHTML = response;
                    this.responseSection.classList.add('show');
                    
                    setTimeout(() => {
                        this.responseSection.scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'start' 
                        });
                    }, 300);
                } catch (error) {
                    console.error('‚ùå Error showing response:', error);
                }
            }

            showError(message) {
                try {
                    this.responseContent.innerHTML = `
                        <div style="color: #d32f2f; background: #ffebee; padding: 20px; border-radius: 15px;">
                            <h4>‚ùå Erreur lors de l'analyse</h4>
                            <p>${message}</p>
                        </div>
                    `;
                    this.responseSection.classList.add('show');
                } catch (error) {
                    console.error('‚ùå Error showing error:', error);
                }
            }
        }

        // Protection contre copie
        document.addEventListener('contextmenu', e => {
            e.preventDefault();
            alert('‚ö†Ô∏è Contenu prot√©g√© par copyright ¬© 2025 Kheloufi\nüìß amine@nexyna.ai');
        });
        
        document.addEventListener('selectstart', e => {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
            e.preventDefault();
        });
        
        // Signature d√©veloppeur
        window.KHELOUFI_COPYRIGHT = {
            author: 'Amine Kheloufi',
            email: 'amine@nexyna.ai',
            year: 2025,
            version: '4.0 Ultimate',
            rights: 'All Rights Reserved',
            license: 'Voir LICENSE file'
        };
        
        // Protection avanc√©e
        Object.freeze(window.KHELOUFI_COPYRIGHT);

        // Fonctions globales
        function connectSensors() {
            medicalAssistant.sensorsConnected = !medicalAssistant.sensorsConnected;
            
            if (medicalAssistant.sensorsConnected) {
                alert('üì± Capteurs connect√©s avec succ√®s !');
                medicalAssistant.updateSensorData();
            } else {
                alert('üì± Capteurs d√©connect√©s');
            }
        }

        function exportToPDF() {
            const content = document.getElementById('responseContent').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Rapport M√©dical IA v4.0 - ${new Date().toLocaleDateString('fr-FR')}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h3, h4, h5 { color: #1976D2; }
                    </style>
                </head>
                <body>
                    <h1>üè• Rapport de Consultation M√©dicale IA v4.0</h1>
                    <p><strong>Date:</strong> ${new Date().toLocaleString('fr-FR')}</p>
                    <p><strong>D√©velopp√© par:</strong> Amine Kheloufi (amine@nexyna.ai)</p>
                    <hr>
                    ${content}
                    <hr>
                    <p style="font-size: 12px; color: #666;">
                        ¬© 2025 Kheloufi - Assistant M√©dical IA v4.0 Ultimate
                        Il ne remplace pas un diagnostic m√©dical professionnel.
                    </p>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function saveToHistory() {
            alert('üíæ Consultation sauvegard√©e avec succ√®s !');
        }

        // Initialisation
        let medicalAssistant;
        document.addEventListener('DOMContentLoaded', () => {
            try {
                medicalAssistant = new MedicalAssistantV4();
                console.log('üéâ Assistant M√©dical IA v4.0 initialis√© avec succ√®s !');
            } catch (error) {
                console.error('‚ùå Erreur lors de l\'initialisation:', error);
            }
        });
    </script>
</body>
</html>
